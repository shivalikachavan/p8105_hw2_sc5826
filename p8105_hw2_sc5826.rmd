---
title: "p8105_hw2_sc5826"
author: "Shivalika Chavan"
date: "2025-09-23"
output: github_document
---
```{r message=FALSE}
library(tidyverse)
library(haven)
month_order = c("January","February","March","April","May","June","July","August","September","October","November","December") 
```

## Problem 1
Cleaning `pols_month.csv`
```{r}
pols_month = read.csv("./data/fivethirtyeight_datasets/pols-month.csv") |> 
  janitor::clean_names() |> 
  separate("mon", into = c("year", "month", "day"), sep = "-", convert = TRUE) |> 
  mutate(
    month =
      recode(
        month,
        `1` = "January",
        `2` = "February",
        `3` = "March",
        `4` = "April",
        `5` = "May",
        `6` = "June",
        `7` = "July",
        `8` = "August",
        `9` = "September",
        `10` = "October",
        `11` = "November",
        `12` = "December"
        ),
    month = factor(month, levels = month_order),
    president = 
      recode(
        prez_dem, # using prez_dem to create president since grez_gop has erroneous values of 2
        `0` = "gop",
        `1` = "dem"
      )
  ) |> 
  select(-day, -prez_dem, -prez_gop) |> # removing day, prez_dem, and prez_gop
  arrange(year, month) |> #arranging by year and month
  relocate(year, month, everything()) # moving year and month to front
```

Cleaning `snp.csv`. The `year` column is either `> 15` or `< 50`. I'm making the assumption that all the years `> 15` are in the 20th century (adding 1900) and all the years `< 50` are in the 21st century (adding 2000). Doing this makes the year column consistent across the `pols_month` and `snp` data frames. 
```{r}
snp = read_csv("./data/fivethirtyeight_datasets/snp.csv") |> 
  janitor::clean_names() |> 
  separate("date", into = c("month", "day", "year"), sep = "/", convert = TRUE) |> 
  mutate(
    month =
      recode(
        month,
        `1` = "January",
        `2` = "February",
        `3` = "March",
        `4` = "April",
        `5` = "May",
        `6` = "June",
        `7` = "July",
        `8` = "August",
        `9` = "September",
        `10` = "October",
        `11` = "November",
        `12` = "December"
        ),
    month = factor(month, levels = month_order),
    year = 
      case_when(
        year > 15 ~ year + 1900,
        .default = year + 2000
      )
  ) |> 
  select(-day) |> # removing day
  arrange(year, month) |> #arranging by year and month
  relocate(year, month, everything()) # moving year and month to front
```

Cleaning `unemployment.csv`.
```{r}
unemployment = read_csv("./data/fivethirtyeight_datasets/unemployment.csv") |> 
  janitor::clean_names() |> 
  pivot_longer(
    jan:dec,
    names_to = "month",
    values_to = "unemployment_pct"
  ) |> 
  mutate(
    month =
      recode(
        month,
        `jan` = "January",
        `feb` = "February",
        `mar` = "March",
        `apr` = "April",
        `may` = "May",
        `jun` = "June",
        `jul` = "July",
        `aug` = "August",
        `sep` = "September",
        `oct` = "October",
        `nov` = "November",
        `dec` = "December"
        ),
    month = factor(month, levels = month_order),
  ) |> 
  arrange(year, month) |> #arranging by year and month
  relocate(year, month, everything()) # moving year and month to front
```
First merging `snp` into `pols_month`, then `unemployment` into the result using left_joins. This keeps all the observations in `pols_month`, since it includes some months and years during which there is no data recorded in `snp` or `unemployment.` 
```{r}
pols_snp_unemployment_df = left_join(pols_month, snp, by = c("year", "month")) |> 
  left_join(unemployment, by = c("year", "month"))
```

The cleaned `pols_month` data set has `r nrow(pols_month)` observations and `r ncol(pols_month)` variables (`r colnames(pols_month)`), ranging from `r min(pull(pols_month, year))` to `r max(pull(pols_month, year))`. The cleaned `snp` data set has `r nrow(snp)` observations and `r ncol(snp)` variables (`r colnames(snp)`), ranging from `r min(pull(snp, year))` to `r max(pull(snp, year))`. The cleaned `unemployment` data set has `r nrow(unemployment)` observations and `r ncol(unemployment)` variables (`r colnames(unemployment)`), ranging from `r min(pull(unemployment, year))` to `r max(pull(unemployment, year))`. 

The resulting data set, `pols_snp_unemployment_df`, has `r nrow(pols_snp_unemployment_df)` observations and `r ncol(pols_snp_unemployment_df)` variables (`r colnames(pols_snp_unemployment_df)`), ranging from `r min(pull(pols_snp_unemployment_df, year))` to `r max(pull(pols_snp_unemployment_df, year))`. This data set contains information about the # of GOP and Democrat governors, senators, representatives (congresspeople), the political party of the president, the closing value of the S&P stock index, and unemployment percentage for each month from `r min(pull(pols_snp_unemployment_df, year))` to `r max(pull(pols_snp_unemployment_df, year))`. Some data about the S&P stock index closing an unemployment percentage was not collected for older months, and is marked as `NA` in these cases. 


